<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Rhetoric Lab</title>
    <!-- Tailwind CSS for Styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React and ReactDOM from CDNs -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- Babel for JSX processing -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .fade-in { animation: fadeIn 0.4s ease-out forwards; }
        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #1e293b; border-radius: 10px; }
        body { background-color: #020617; color: #f8fafc; margin: 0; font-family: sans-serif; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        const Icons = {
            Cpu: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="shrink-0"><rect x="4" y="4" width="16" height="16" rx="2" ry="2"/><rect x="9" y="9" width="6" height="6"/><line x1="9" y1="1" x2="9" y2="4"/><line x1="15" y1="1" x2="15" y2="4"/><line x1="9" y1="20" x2="9" y2="23"/><line x1="15" y1="20" x2="15" y2="23"/><line x1="20" y1="9" x2="23" y2="9"/><line x1="20" y1="15" x2="23" y2="15"/><line x1="1" y1="9" x2="4" y2="9"/><line x1="1" y1="15" x2="4" y2="15"/></svg>,
            MessageSquare: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="shrink-0"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>,
            ShieldCheck: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="shrink-0"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/><path d="m9 12 2 2 4-4"/></svg>,
            Send: () => <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="shrink-0"><line x1="22" y1="2" x2="11" y2="13"/><polyline points="22 2 15 22 11 13 2 9 22 2"/></svg>,
            RotateCcw: () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="shrink-0"><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><polyline points="3 3 3 8 8 8"/></svg>,
            Sparkles: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="shrink-0"><path d="m12 3 1.912 5.813a2 2 0 0 0 1.275 1.275L21 12l-5.813 1.912a2 2 0 0 0-1.275 1.275L12 21l-1.912-5.813a2 2 0 0 0-1.275-1.275L3 12l5.813-1.912a2 2 0 0 0 1.275-1.275L12 3Z"/><path d="M5 3v4"/><path d="M3 5h4"/><path d="M21 17v4"/><path d="M19 19h4"/></svg>,
            Info: () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="shrink-0"><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/></svg>,
            X: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="shrink-0"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>,
            FileText: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="shrink-0"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/></svg>,
            ClipboardCheck: () => <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="shrink-0"><rect x="8" y="2" width="8" height="4" rx="1" ry="1"/><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"/><path d="m9 14 2 2 4-4"/></svg>,
            Check: () => <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="shrink-0"><polyline points="20 6 9 17 4 12"/></svg>
        };

        const App = () => {
            const [activeStep, setActiveStep] = useState(0);
            const [chatHistory, setChatHistory] = useState([]);
            const [userInput, setUserInput] = useState("");
            const [vectorInput, setVectorInput] = useState("");
            const [guardrailInput, setGuardrailInput] = useState("");
            const [megaPrompt, setMegaPrompt] = useState({ ethos: '', logos: '', pathos: '' });
            const [isTyping, setIsTyping] = useState(false);
            const [showModal, setShowModal] = useState(false);
            const [modalContent, setModalContent] = useState({ title: '', body: '', isReport: false });
            const [copied, setCopied] = useState(false);
            
            const scrollRef = useRef(null);

            const scholars = {
                tenen: { name: "Dennis Yi Tenen", concept: "The Mathematics of Language", quote: "Language is a pattern-matching system, not a truth-telling one." },
                mollick: { name: "Ethan Mollick", concept: "Co-Intelligence", quote: "Treat the AI as a smart but fallible intern." },
                li: { name: "Fei-Fei Li", concept: "Human-Centered AI", quote: "AI must enhance human dignity, not replace it." }
            };

            const steps = [
                { id: 'tenen', title: 'Lab 1: Vectorization', icon: <Icons.Cpu />, scholar: scholars.tenen },
                { id: 'socratic', title: 'Lab 2: Socratic Elenchus', icon: <Icons.MessageSquare />, scholar: scholars.mollick },
                { id: 'rhetoric', title: 'Lab 3: The Mega-Prompt', icon: <Icons.Sparkles />, scholar: scholars.mollick },
                { id: 'ethics', title: 'Lab 4: The Guardrails', icon: <Icons.ShieldCheck />, scholar: scholars.li }
            ];

            useEffect(() => {
                if (scrollRef.current) {
                    scrollRef.current.scrollTop = scrollRef.current.scrollHeight;
                }
            }, [chatHistory, isTyping]);

            const triggerModal = (title, body, isReport = false) => {
                setModalContent({ title, body, isReport });
                setShowModal(true);
            };

            const handleSocraticChat = () => {
                if (!userInput.trim()) return;
                const newMsg = { role: 'user', content: userInput };
                setChatHistory(prev => [...prev, newMsg]);
                setUserInput("");
                setIsTyping(true);

                setTimeout(() => {
                    const responses = [
                        "That is a broad claim. By what criteria are you defining the 'value' in that sentence?",
                        "If we accept your premise, does it not follow that the opposite must also be true in certain contexts?",
                        "Interesting. How would Tenen's 'mathematical probability' explain that specific word choice?",
                        "Let's look deeper. Provide a counter-example to your last statement."
                    ];
                    const aiMsg = { 
                        role: 'assistant', 
                        content: responses[Math.floor(Math.random() * responses.length)] 
                    };
                    setChatHistory(prev => [...prev, aiMsg]);
                    setIsTyping(false);
                }, 1000);
            };

            const generateReport = () => {
                const report = `AI RHETORIC LAB - ASSIGNMENT REPORT\nGenerated: ${new Date().toLocaleString()}\n------------------------------------------\n\n1. VECTORIZATION:\n${vectorInput || "No input"}\n\n2. SOCRATIC DIALOGUE:\n${chatHistory.map(m => `[${m.role.toUpperCase()}]: ${m.content}`).join('\n')}\n\n3. MEGA-PROMPT:\nEthos: ${megaPrompt.ethos}\nLogos: ${megaPrompt.logos}\nPathos: ${megaPrompt.pathos}\n\n4. ETHICAL GUARDRAILS:\n${guardrailInput}`;
                triggerModal("Final Assignment Data", report, true);
            };

            const copyToClipboard = (text) => {
                const textArea = document.createElement("textarea");
                textArea.value = text;
                textArea.style.position = "fixed";
                textArea.style.left = "-9999px";
                document.body.appendChild(textArea);
                textArea.select();
                try {
                    document.execCommand('copy');
                    setCopied(true);
                    setTimeout(() => setCopied(false), 2000);
                } catch (err) {
                    console.error("Copy failed", err);
                }
                document.body.removeChild(textArea);
            };

            return (
                <div className="min-h-screen p-4 md:p-8 overflow-x-hidden">
                    <header className="max-w-6xl mx-auto mb-8 border-b border-slate-800 pb-6 flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
                        <div>
                            <h1 className="text-3xl font-bold bg-gradient-to-r from-blue-400 to-emerald-400 bg-clip-text text-transparent">AI Rhetoric Lab</h1>
                            <p className="text-slate-400 text-sm mt-1">Critical AI Scholarship Interactive</p>
                        </div>
                        <div className="text-[10px] font-mono text-blue-500 bg-blue-500/10 px-3 py-1 rounded-full border border-blue-500/20 underline tracking-tighter">v2.1-stable-fix</div>
                    </header>

                    <main className="max-w-6xl mx-auto grid grid-cols-1 lg:grid-cols-4 gap-8">
                        <nav className="lg:col-span-1 space-y-2">
                            {steps.map((step, index) => (
                                <button
                                    key={step.id}
                                    onClick={() => setActiveStep(index)}
                                    className={`w-full flex items-center gap-3 p-4 rounded-xl border transition-all text-left ${activeStep === index ? 'bg-blue-600 border-blue-400 text-white shadow-lg' : 'bg-slate-900 border-slate-800 text-slate-400 hover:bg-slate-800'}`}
                                >
                                    {step.icon}
                                    <span className="font-semibold text-sm">{step.title}</span>
                                </button>
                            ))}
                            <div className="mt-6 p-4 bg-slate-900/50 rounded-xl border border-slate-800">
                                <div className="text-blue-400 mb-2"><Icons.Info /></div>
                                <p className="text-xs font-bold text-slate-200">{steps[activeStep].scholar.name}</p>
                                <p className="text-[11px] text-slate-400 italic mt-1">"{steps[activeStep].scholar.quote}"</p>
                            </div>
                        </nav>

                        <section className="lg:col-span-3 bg-slate-900/40 rounded-3xl border border-slate-800 flex flex-col min-h-[550px] relative overflow-hidden">
                            <div className="flex-1 p-6 md:p-8 fade-in custom-scrollbar overflow-y-auto">
                                {activeStep === 0 && (
                                    <div className="space-y-6">
                                        <h2 className="text-2xl font-bold flex items-center gap-2"><Icons.Cpu /> Vectorization</h2>
                                        <p className="text-slate-400 text-sm leading-relaxed">Dennis Yi Tenen notes that LLMs map language patterns rather than meaning. Define a <strong>semantic boundary</strong> below.</p>
                                        <div className="bg-slate-950 p-4 rounded-xl border border-slate-800 font-mono text-xs text-emerald-500">"Explain the concept of liberty."</div>
                                        <textarea 
                                            value={vectorInput}
                                            onChange={(e) => setVectorInput(e.target.value)}
                                            className="w-full bg-slate-950 border border-slate-800 rounded-xl p-4 text-sm min-h-[150px] focus:ring-1 focus:ring-blue-500 outline-none"
                                            placeholder="How would you force the AI to compare liberty across specific historical vectors?"
                                        />
                                    </div>
                                )}

                                {activeStep === 1 && (
                                    <div className="flex flex-col h-full">
                                        <h2 className="text-2xl font-bold flex items-center gap-2 mb-4"><Icons.MessageSquare /> Socratic Elenchus</h2>
                                        <div ref={scrollRef} className="flex-1 bg-slate-950/50 rounded-2xl p-4 mb-4 overflow-y-auto custom-scrollbar min-h-[250px] space-y-4">
                                            {chatHistory.length === 0 && (
                                                <div className="h-full flex items-center justify-center text-slate-600 text-xs italic">
                                                    Start a dialogue with the scholar...
                                                </div>
                                            )}
                                            {chatHistory.map((m, i) => (
                                                <div key={i} className={`flex ${m.role === 'user' ? 'justify-end' : 'justify-start'}`}>
                                                    <div className={`p-3 rounded-xl text-sm max-w-[80%] ${m.role === 'user' ? 'bg-blue-600' : 'bg-slate-800 border border-slate-700'}`}>
                                                        {m.content}
                                                    </div>
                                                </div>
                                            ))}
                                            {isTyping && <div className="text-xs text-slate-500 animate-pulse">Scholar is typing...</div>}
                                        </div>
                                        <div className="flex gap-2">
                                            <input 
                                                value={userInput}
                                                onChange={(e) => setUserInput(e.target.value)}
                                                onKeyDown={(e) => e.key === 'Enter' && handleSocraticChat()}
                                                className="flex-1 bg-slate-950 border border-slate-800 rounded-xl px-4 py-3 text-sm"
                                                placeholder="Challenge the AI's logic..."
                                            />
                                            <button onClick={handleSocraticChat} className="bg-emerald-600 p-3 rounded-xl hover:bg-emerald-500 transition-colors"><Icons.Send /></button>
                                        </div>
                                    </div>
                                )}

                                {activeStep === 2 && (
                                    <div className="space-y-6">
                                        <h2 className="text-2xl font-bold flex items-center gap-2"><Icons.Sparkles /> Mega-Prompting</h2>
                                        <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                                            {['ethos', 'logos', 'pathos'].map(field => (
                                                <div key={field}>
                                                    <label className="text-[10px] uppercase font-bold text-slate-500 block mb-2">{field}</label>
                                                    <textarea 
                                                        value={megaPrompt[field]}
                                                        onChange={(e) => setMegaPrompt({...megaPrompt, [field]: e.target.value})}
                                                        className="w-full bg-slate-950 border border-slate-800 rounded-xl p-3 text-xs h-32 resize-none"
                                                        placeholder={`Define ${field}...`}
                                                    />
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                )}

                                {activeStep === 3 && (
                                    <div className="space-y-6">
                                        <h2 className="text-2xl font-bold flex items-center gap-2"><Icons.ShieldCheck /> Guardrails</h2>
                                        <p className="text-sm text-slate-400 italic">"AI must enhance human dignity." â€” Fei-Fei Li</p>
                                        <textarea 
                                            value={guardrailInput}
                                            onChange={(e) => setGuardrailInput(e.target.value)}
                                            className="w-full bg-slate-950 border border-slate-800 rounded-xl p-4 text-sm min-h-[150px]"
                                            placeholder="Analyze the potential bias in your mega-prompt..."
                                        />
                                        <button onClick={generateReport} className="w-full bg-emerald-600 py-4 rounded-xl font-bold hover:bg-emerald-500 transition-all flex items-center justify-center gap-2 shadow-lg">
                                            <Icons.FileText /> Compile Submission
                                        </button>
                                    </div>
                                )}
                            </div>

                            <div className="p-4 bg-slate-950/50 border-t border-slate-800 flex justify-between items-center">
                                <div className="text-[10px] text-slate-500 font-bold uppercase tracking-widest">Progress: {activeStep + 1}/4</div>
                                <div className="flex gap-2">
                                    <button disabled={activeStep === 0} onClick={() => setActiveStep(prev => prev - 1)} className="px-4 py-2 text-xs text-slate-500 hover:text-white disabled:opacity-0 transition-opacity">Back</button>
                                    <button disabled={activeStep === 3} onClick={() => setActiveStep(prev => prev + 1)} className="bg-slate-100 text-slate-900 px-6 py-2 rounded-lg text-xs font-black hover:bg-white disabled:opacity-0 transition-all">Next</button>
                                </div>
                            </div>
                        </section>
                    </main>

                    {showModal && (
                        <div className="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm">
                            <div className="bg-slate-900 border border-slate-800 rounded-2xl p-6 max-w-2xl w-full max-h-[80vh] flex flex-col shadow-2xl">
                                <div className="flex justify-between items-center mb-4">
                                    <h3 className="font-bold">{modalContent.title}</h3>
                                    <button onClick={() => setShowModal(false)} className="text-slate-500 hover:text-white"><Icons.X /></button>
                                </div>
                                <div className="flex-1 bg-slate-950 p-4 rounded-xl font-mono text-[10px] text-slate-400 overflow-y-auto custom-scrollbar whitespace-pre-wrap border border-slate-800">
                                    {modalContent.body}
                                </div>
                                <div className="mt-4 flex gap-2">
                                    {modalContent.isReport && (
                                        <button 
                                            onClick={() => copyToClipboard(modalContent.body)}
                                            className={`flex-1 py-3 rounded-xl font-bold text-xs flex items-center justify-center gap-2 transition-all ${copied ? 'bg-emerald-500 text-white' : 'bg-blue-600 text-white'}`}
                                        >
                                            {copied ? <Icons.Check /> : <Icons.ClipboardCheck />} {copied ? 'Copied' : 'Copy Text'}
                                        </button>
                                    )}
                                    <button onClick={() => setShowModal(false)} className="px-6 py-3 bg-slate-800 rounded-xl text-xs font-bold text-white">Close</button>
                                </div>
                            </div>
                        </div>
                    )}

                    <footer className="max-w-6xl mx-auto mt-8 flex justify-between items-center text-[10px] text-slate-600 font-bold uppercase tracking-widest">
                        <span>Rhetoric of Technology Lab</span>
                        <button onClick={() => triggerModal("Reset Lab", "This will wipe all current session data. Are you sure?")} className="flex items-center gap-1 hover:text-red-400 transition-colors"><Icons.RotateCcw /> Reset Session</button>
                    </footer>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
