<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Workshop Portal: The Human Algorithm</title>
    <!-- React and ReactDOM -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Firebase SDKs -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getFirestore, collection, addDoc, onSnapshot, serverTimestamp, query, doc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";

        // Expose Firebase to the React scope
        window.FirebaseUtils = {
            initializeApp, getFirestore, collection, addDoc, onSnapshot, serverTimestamp,
            getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged, query, doc
        };
    </script>
    <style>
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .animate-in { animation: fadeIn 0.4s ease-out forwards; }
        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #e2e8f0; border-radius: 10px; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #cbd5e1; }
        
        /* Helper classes for dynamic coloring since Tailwind JIT can sometimes miss dynamic string templates in pure HTML files */
        .bg-indigo-600 { background-color: #4f46e5; }
        .bg-emerald-600 { background-color: #059669; }
        .bg-blue-600 { background-color: #2563eb; }
        .text-indigo-600 { color: #4f46e5; }
        .text-emerald-600 { color: #059669; }
        .text-blue-600 { color: #2563eb; }
        .border-indigo-100 { border-color: #e0e7ff; }
        .border-emerald-100 { border-color: #d1fae5; }
        .border-blue-100 { border-color: #dbeafe; }
    </style>
</head>
<body class="bg-slate-50">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;
        const { 
            getFirestore, collection, addDoc, onSnapshot, serverTimestamp,
            getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged 
        } = window.FirebaseUtils;

        // Constants and Configuration
        const firebaseConfig = JSON.parse(__firebase_config);
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'human-algorithm-workshop';
        const app = window.FirebaseUtils.initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        const SKILLS = ['Critical Thinking', 'Creativity', 'Collaboration', 'Frontier Thinking', 'Experiential Learning', 'Design Thinking'];
        const AI_TOOLS = ['GEMs', 'NotebookLM', 'Generative AI', 'Ethical AI'];

        const CASE_STUDIES = {
            addison: {
                id: 'addison',
                name: 'Addison',
                tag: 'Creative Agency',
                color: 'indigo',
                accentHex: '#4f46e5',
                title: 'The Human Algorithm: Why the Future of Learning at UNC Charlotte Must Start with the Soul',
                content: (
                    <div className="text-slate-700 leading-relaxed space-y-6">
                        <p><strong>CHARLOTTE, NC</strong> — On the third floor of the J. Murrey Atkins Library, the rhythmic symphony of mechanical keyboards fills the air. Among the students is <strong>Addison</strong>, a sophomore at UNC Charlotte.</p>
                        <p>Addison is a first-generation student with a passion for theater and music. However, he also navigates life with ADHD. While he is diligent, he feels that the current "digital-first" academic requirements are more about jumping through hoops than meaningful growth.</p>
                        <h3 className="text-xl font-bold text-slate-900 pt-4">The "Repetitive Rigor" Trap</h3>
                        <p>"I came here ready to be inspired," Addison says. "But half my nights are spent posting to discussion forums where everyone says the same thing. It’s rigorous in terms of time, but it feels hollow."</p>
                        <h3 className="text-xl font-bold text-slate-900 pt-4">Starting with the Human Experience</h3>
                        <p>How can technology empower Addison to turn a sociology essay into a dramatic monologue? How can AI act as a collaborative partner in his creative process rather than just a shortcut?</p>
                        <blockquote className="border-l-4 border-indigo-500 pl-4 py-3 italic text-slate-600 bg-slate-50 rounded-r-lg shadow-sm">
                            "The AAC&U approach to student success emphasizes institutional responsibility for both academic achievement and the development of skills needed for life after college."
                        </blockquote>
                    </div>
                ),
                objective: "Brainstorm concrete ways Addison can use AI (GEMs, NotebookLM) to amplify his human skills. How can AI act as a collaborative partner in his creative process?"
            },
            maya: {
                id: 'maya',
                name: 'Maya',
                tag: 'Time Equity',
                color: 'emerald',
                accentHex: '#059669',
                title: 'The Margin of Error: Navigating Time Poverty in the Environmental Science Lab',
                content: (
                    <div className="text-slate-700 leading-relaxed space-y-6">
                        <p><strong>CHARLOTTE, NC</strong> — <strong>Maya</strong>, a senior in Environmental Science, is finishing her first "shift" of the day as the sun rises. She hasn't slept more than five hours a night this semester.</p>
                        <p>Working 30 hours a week while caring for her grandmother, Maya lives in "Time Poverty." Her capstone requires synthesizing hundreds of pages of technical reports—a task that demands deep focus her life doesn't always permit.</p>
                        <h3 className="text-xl font-bold text-slate-900 pt-4">The "Cognitive Load" Barrier</h3>
                        <p>"By the time I’ve navigated the technical jargon on the bus, my stop is here," Maya explains. "I feel like I'm constantly restarting from zero because I don't have the luxury of long study blocks."</p>
                        <h3 className="text-xl font-bold text-slate-900 pt-4">Designing for the Overburdened</h3>
                        <p>How can tools like NotebookLM help her turn a 50-page technical report into a high-level briefing she can digest during her commute, allowing her to spend her precious "deep focus" time on analysis?</p>
                        <blockquote className="border-l-4 border-emerald-500 pl-4 py-3 italic text-slate-600 bg-slate-50 rounded-r-lg shadow-sm">
                            "Success means providing tools that respect her time and acknowledge that her life outside the classroom is a reality we must design for."
                        </blockquote>
                    </div>
                ),
                objective: "Explore how Maya can use AI to manage 'Time Poverty.' How can technology help her maintain analytical depth within a fragmented schedule?"
            },
            leo: {
                id: 'leo',
                name: 'Leo',
                tag: 'Foundational Sense-Making',
                color: 'blue',
                accentHex: '#2563eb',
                title: 'Lost in the Lecture Hall: Bridging the "Expert-Novice" Gap in First-Year Chemistry',
                content: (
                    <div className="text-slate-700 leading-relaxed space-y-6">
                        <p><strong>CHARLOTTE, NC</strong> — In a lecture hall of 300, <strong>Leo</strong> feels invisible. A first-year Mechanical Engineering major, he arrived with high marks, but Chemistry 1251 feels like an impenetrable wall of abstract formulas.</p>
                        <p>Leo is a conceptual learner; he needs to see how the gears mesh. But in foundational STEM, he is met with a barrage of trends that seem disconnected from the physical world he loves to build in.</p>
                        <h3 className="text-xl font-bold text-slate-900 pt-4">The "Imposter" Silence</h3>
                        <p>"I have a dozen questions, but I don't want to slow down 300 people," Leo admits. "So I stay quiet and try to teach myself from a textbook that reads like a manual."</p>
                        <h3 className="text-xl font-bold text-slate-900 pt-4">The AI Socratic Tutor</h3>
                        <p>What if Leo had a 24/7 Socratic tutor that helps him visualize molecular structures as mechanical systems? We can use AI to build a bridge from his existing knowledge to these abstract concepts.</p>
                        <blockquote className="border-l-4 border-blue-500 pl-4 py-3 italic text-slate-600 bg-slate-50 rounded-r-lg shadow-sm">
                            "Institutional responsibility includes fostering the confidence to ask questions and the agency to use technology as a personal laboratory for thought."
                        </blockquote>
                    </div>
                ),
                objective: "Discuss how Leo can use AI as a 'Socratic Partner' to bridge the expert-novice gap. How can AI help him translate abstract concepts into visual language?"
            }
        };

        const Icons = {
            Brain: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 4.44-2.54Z"/><path d="M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-4.44-2.54Z"/></svg>,
            Lightbulb: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .5 2.2 1.5 3.1.7.7 1.3 1.5 1.5 2.5"/><path d="M9 18h6"/><path d="M10 22h4"/></svg>,
            Users: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>,
            Send: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg>,
            User: () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>,
            ExternalLink: () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>,
            Sparkles: () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"/><path d="M5 3v4"/><path d="M19 17v4"/><path d="M3 5h4"/><path d="M17 19h4"/></svg>
        };

        function App() {
            const [user, setUser] = useState(null);
            const [ideas, setIdeas] = useState([]);
            const [newIdea, setNewIdea] = useState('');
            const [selectedSkill, setSelectedSkill] = useState(SKILLS[0]);
            const [selectedAI, setSelectedAI] = useState(AI_TOOLS[0]);
            const [userName, setUserName] = useState('');
            const [authLoading, setAuthLoading] = useState(true);
            const [activeCase, setActiveCase] = useState('addison');

            useEffect(() => {
                const initAuth = async () => {
                    try {
                        if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {
                            await signInWithCustomToken(auth, __initial_auth_token);
                        } else {
                            await signInAnonymously(auth);
                        }
                    } catch (err) {
                        console.error("Auth failed", err);
                    } finally {
                        setAuthLoading(false);
                    }
                };
                initAuth();
                const unsubscribe = onAuthStateChanged(auth, (u) => setUser(u));
                return () => unsubscribe();
            }, []);

            useEffect(() => {
                if (authLoading || !user) return;
                const ideasRef = collection(db, 'artifacts', appId, 'public', 'data', 'brainstorming');
                const unsubscribe = onSnapshot(ideasRef, (snapshot) => {
                    const docs = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                    setIdeas(docs.sort((a, b) => (b.createdAt?.toMillis() || 0) - (a.createdAt?.toMillis() || 0)));
                }, (err) => console.error("Firestore error:", err));
                return () => unsubscribe();
            }, [user, authLoading]);

            const handleSubmitIdea = async (e) => {
                e.preventDefault();
                if (!newIdea.trim() || !user) return;
                try {
                    await addDoc(collection(db, 'artifacts', appId, 'public', 'data', 'brainstorming'), {
                        text: newIdea,
                        author: userName.trim() || 'Anonymous Participant',
                        authorId: user.uid,
                        skill: selectedSkill,
                        aiTool: selectedAI,
                        caseStudy: activeCase,
                        createdAt: serverTimestamp()
                    });
                    setNewIdea('');
                } catch (err) { console.error("Error adding idea:", err); }
            };

            const currentCase = CASE_STUDIES[activeCase];

            return (
                <div className="min-h-screen bg-slate-50 flex flex-col md:flex-row font-sans">
                    {/* Left: Case Study Sidebar */}
                    <aside className="w-full md:w-1/2 lg:w-2/5 md:h-screen overflow-y-auto bg-white border-r border-slate-200 p-6 md:p-10 custom-scrollbar relative">
                        <div className="flex gap-2 mb-8 bg-slate-100 p-1.5 rounded-xl self-start w-fit flex-wrap">
                            {Object.values(CASE_STUDIES).map((cs) => (
                                <button 
                                    key={cs.id}
                                    onClick={() => setActiveCase(cs.id)}
                                    className={`px-4 py-1.5 rounded-lg text-xs font-bold transition-all ${activeCase === cs.id ? `bg-white shadow-sm text-${cs.color}-600` : 'text-slate-500 hover:text-slate-700'}`}
                                >
                                    {cs.name}
                                </button>
                            ))}
                        </div>

                        <div className="max-w-2xl mx-auto animate-in" key={activeCase}>
                            <div className="flex items-center gap-2 mb-4">
                                <span style={{ color: currentCase.accentHex }}><Icons.Brain /></span>
                                <span className={`px-3 py-1 text-sm font-semibold rounded-full uppercase tracking-wider bg-${currentCase.color}-100 text-${currentCase.color}-700`}>
                                    Case Study: {currentCase.tag}
                                </span>
                            </div>
                            
                            <h1 className="text-3xl font-bold text-slate-900 mb-8 leading-tight">
                                {currentCase.title}
                            </h1>
                            
                            {currentCase.content}

                            <div className={`mt-8 p-6 border rounded-xl mb-12 bg-${currentCase.color}-50/50 border-${currentCase.color}-100`}>
                                <h4 className="flex items-center gap-2 font-bold mb-3 text-slate-900">
                                    <span style={{ color: currentCase.accentHex }}><Icons.Lightbulb /></span> Workshop Objective
                                </h4>
                                <p className="text-slate-600 text-sm italic">
                                    {currentCase.objective}
                                </p>
                            </div>
                        </div>
                    </aside>

                    {/* Right: Idea Lab */}
                    <main className="flex-1 md:h-screen overflow-y-auto flex flex-col bg-white">
                        <header className="bg-white border-b border-slate-200 p-4 sticky top-0 z-20 flex flex-wrap justify-between items-center gap-4 shadow-sm">
                            <div className="flex items-center gap-4">
                                <div className="flex items-center gap-2">
                                    <span className="text-indigo-600"><Icons.Users /></span>
                                    <h2 className="font-bold text-slate-800">Idea Lab</h2>
                                    <span className="text-xs bg-green-100 text-green-700 px-2 py-0.5 rounded-full animate-pulse">Live</span>
                                </div>
                                <a 
                                    href="https://gemini.google.com/gem/1lJP5Wvs8uMzJstsnzQCkcv23G3w2TZhj?usp=sharing" 
                                    target="_blank" 
                                    rel="noopener noreferrer"
                                    className="hidden sm:inline-flex items-center gap-2 bg-indigo-600 text-white px-4 py-1.5 rounded-full font-bold text-xs hover:bg-indigo-700 transition-all shadow-md"
                                >
                                    <Icons.Sparkles />
                                    Collaborate with GEM
                                    <Icons.ExternalLink />
                                </a>
                            </div>

                            <div className="flex items-center gap-2 bg-slate-50 border border-slate-200 rounded-lg px-3 py-1.5">
                                <span className="text-slate-400"><Icons.User /></span>
                                <input 
                                    type="text" 
                                    placeholder="Your Name (Optional)" 
                                    className="bg-transparent text-sm text-slate-700 outline-none w-32 md:w-48"
                                    value={userName}
                                    onChange={(e) => setUserName(e.target.value)}
                                />
                            </div>
                        </header>

                        <div className="p-4 md:p-6 border-b border-slate-100 bg-slate-50/50">
                            <form onSubmit={handleSubmitIdea} className="space-y-4 max-w-3xl mx-auto">
                                <div className="grid grid-cols-1 sm:grid-cols-2 gap-4">
                                    <div>
                                        <label className="block text-[10px] font-bold text-slate-500 uppercase mb-1">Human Skill Focus</label>
                                        <select 
                                            className="w-full bg-white border border-slate-200 rounded-lg px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-indigo-500 appearance-none"
                                            value={selectedSkill}
                                            onChange={(e) => setSelectedSkill(e.target.value)}
                                        >
                                            {SKILLS.map(s => <option key={s} value={s}>{s}</option>)}
                                        </select>
                                    </div>
                                    <div>
                                        <label className="block text-[10px] font-bold text-slate-500 uppercase mb-1">AI Tool/Framework</label>
                                        <select 
                                            className="w-full bg-white border border-slate-200 rounded-lg px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-indigo-500 appearance-none"
                                            value={selectedAI}
                                            onChange={(e) => setSelectedAI(e.target.value)}
                                        >
                                            {AI_TOOLS.map(t => <option key={t} value={t}>{t}</option>)}
                                        </select>
                                    </div>
                                </div>
                                <div className="relative">
                                    <textarea
                                        className="w-full bg-white border border-slate-200 rounded-lg p-4 text-slate-800 placeholder-slate-400 focus:ring-2 focus:ring-indigo-500 outline-none min-h-[120px] shadow-sm"
                                        placeholder={`Suggest a way for ${currentCase.name} to use AI...`}
                                        value={newIdea}
                                        onChange={(e) => setNewIdea(e.target.value)}
                                    />
                                    <button
                                        type="submit"
                                        className={`absolute bottom-4 right-4 text-white p-2 rounded-full shadow-md transition-all hover:scale-105 disabled:opacity-50 bg-${currentCase.color}-600`}
                                        disabled={authLoading || !user || !newIdea.trim()}
                                    >
                                        <Icons.Send />
                                    </button>
                                </div>
                            </form>
                        </div>

                        <div className="p-4 md:p-6 grid grid-cols-1 lg:grid-cols-2 gap-4 content-start custom-scrollbar">
                            {ideas.length === 0 ? (
                                <div className="col-span-full py-20 text-center flex flex-col items-center gap-4 text-slate-400">
                                    <Icons.Users />
                                    <p>{authLoading ? 'Connecting to workshop...' : 'No ideas yet. Be the first to contribute!'}</p>
                                </div>
                            ) : (
                                ideas.map((idea) => {
                                    const cs = CASE_STUDIES[idea.caseStudy] || CASE_STUDIES.addison;
                                    return (
                                        <div key={idea.id} className="bg-white p-5 rounded-xl border border-slate-200 shadow-sm animate-in hover:shadow-md transition-shadow relative overflow-hidden">
                                            <div className={`absolute top-0 right-0 w-1 h-full bg-${cs.color}-400`}></div>
                                            <div className="flex flex-wrap gap-2 mb-3">
                                                <span className="px-2 py-0.5 bg-slate-100 text-slate-600 text-[10px] font-bold uppercase rounded tracking-wider">{idea.skill}</span>
                                                <span className="px-2 py-0.5 bg-slate-100 text-slate-600 text-[10px] font-bold uppercase rounded tracking-wider">{idea.aiTool}</span>
                                                <span className={`px-2 py-0.5 text-[10px] font-bold uppercase rounded tracking-wider bg-${cs.color}-50 text-${cs.color}-600`}>
                                                    For: {cs.name}
                                                </span>
                                            </div>
                                            <p className="text-slate-700 mb-4 whitespace-pre-wrap leading-relaxed text-sm italic">"{idea.text}"</p>
                                            <div className="flex items-center justify-between border-t border-slate-50 pt-3">
                                                <div className="flex items-center gap-2">
                                                    <div className={`w-6 h-6 rounded-full flex items-center justify-center text-[10px] font-bold text-white uppercase bg-${cs.color}-500`}>
                                                        {idea.author?.[0] || 'A'}
                                                    </div>
                                                    <span className="text-xs font-medium text-slate-600 truncate max-w-[120px]">{idea.author}</span>
                                                </div>
                                                <span className="text-[10px] text-slate-400 tabular-nums">
                                                    {idea.createdAt ? new Date(idea.createdAt.seconds * 1000).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }) : 'Just now'}
                                                </span>
                                            </div>
                                        </div>
                                    );
                                })
                            )}
                        </div>
                    </main>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>